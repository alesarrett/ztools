## zrunner 
#### platfrom independent wrapper for running and benchmarking Zonation

[Zonation](http://cbig.it.helsinki.fi/software/zonation/) conservation 
prioritization software can be run using both a GUI and command line interface. 
Often when running analyses runs in batch, repeating runs, or running the 
analysis in headless environments (such as Linux  servers/computational units) 
it is useful to use Zonation's command line interface instead of the GUI. One 
way to build these CLI scripts is to use 
[batch files](http://en.wikipedia.org/wiki/Batch_file) - or bat-files - as 
suggested in the Zonation manual. Bat-files are also the foundation of Zonation
"projects" as they define the necessary configuration files and parameters
for a particular run. However, bat-files cannot be used on other platforms 
such as Linux. 

In a nutshell, zrunner is meant for:

1. Running Zonation runs in a platform independent way
2. Providing additional information on the run (Was the run successful? How long 
did the different stages take? What's the system configuration?)
3. Benchmarking Zonation on different hardware/software/OS configurations

Note that Zonation already reports much of the information mentioned in 2. In
fact, some of the information is parsed/deduced directly from the 
run info file generated by Zonation. The added value here is that the results
are in more concise form and direclty machine readable.

zrunner package includes two command line utilities:

1. `zrunner` for running the Zonation-files and generating records of the run 
1. `zreader` for reporting the results produced by `zrunner`

## Install

**WARNING** as `zrunner` has only reached version 0.1 be prepared for nothing
to work and everything to change at later stage.

#### Dependencies

* Python 2.7+ (may work with older version as well, untested)
* [pip](http://www.pip-installer.org/en/latest/) (needed only if installing using pip).
* [PyYAML](http://pyyaml.org/). NOTE: pip/setuptools will try to install this as 
well so this stage is optional. On some platforms `libyaml-dev` or similar is needed.

#### Using pip

1. Install `zrunner` directly from [GitHub](https://github.com/cbig/zrunner) 
using the following command (may need administrative privileges):  

```
pip install https://github.com/cbig/zrunner/archive/master.zip
```

#### Using git

1. Clone the repository:
```
git clone https://github.com/cbig/zrunner.git
```
2. In the package folder, install the `zrunner` with the following command:

```
python setup.py install
```

#### Using bootstrapped setuptools

This option is not very well tested. 

1. Download the package from https://github.com/cbig/zrunner/archive/master.zip
2. Unzip the folder
3. In the package folder, install the `zrunner` with the following command:

```
python setup.py install
```

## Quick usage

#### zrunner

Quick roundup of available options:

```
usage: zrunner [-h] [-l YAMLFILE] [-x EXECUTABLE] [-o OUTPUT_FILE]
               [-w OVERWRITE] [-s]
               [INPUTS]

Run Zonation runs andperformance benchmarks.

positional arguments:
  INPUTS                input bat/sh file

optional arguments:
  -h, --help            show this help message and exit
  -l YAMLFILE, --load YAMLFILE
                        yaml file defining a suite of input files
  -x EXECUTABLE, --executable EXECUTABLE
                        select Zonation executable (must in PATH)
  -o OUTPUT_FILE, --outputfile OUTPUT_FILE
                        name of the output file
  -w OVERWRITE, --overwrite OVERWRITE
                        overwrite existing result file
  -s, --silent          run everything silent

```

The following examples use [the basic Zonation tutorial runs](https://github.com/cbig/zonation-tutorial/tree/master/basic)
and assume that you are located in folder `zonation-tutorial/basic`.

**Running a bat file**

Simply point a given bat-file to `zrunner`:

```
zrunner do_01_core_area_zonation.bat
```

Note that unless you use the silent switch `-s/--silent` an putput file will be 
produced.

**Running a suite of bat-files as defined in a YAML file**

Run all the runs in the `tests` folder:

```
zrunner -l tests/ztests_basic.yaml
```

The output will be created in the same folder with name pattern `results_[YOUR_COMPUTER_NAME].yaml` or 
you can define the output file name using the `-o/--outputfile` switch.

**Running a bat-file using different Zonation versions**

**Just run the runs, no outputs**
